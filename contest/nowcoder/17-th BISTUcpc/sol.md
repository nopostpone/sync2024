# 第十七届北京信息科技大学程序设计竞赛 简要题解

author: postpone

## A

最优的方案是把最长的两个木板作为边界。

## B

我们把这个操作视为一个映射 $a\mapsto L(a)$。对于一个 $a$，如果我们把它的末尾反转（$0\leftrightarrow 1$），那么答案也会反转。那么在所有数组中，$L(a)$ 取 $0$ 和取 $1$ 的数量相同，各为总数的一半。

因此答案为 $2^{n-1}$。复杂度 $O(T\log n)$。

## C

将整个棋盘染成黑白相间的颜色（不妨令起点是黑色）。此时任意两个相邻的格子颜色都不同。如果起点和终点是一个颜色，那么整个路径走过的黑色格子比白色格子多 $1$ 个；否则走过的黑色格子和白色格子数量相同。于是检查整个棋盘的黑白格子数量，是否符合要求即可。

在此基础上研究，可以得到更简单的结论：如果 $n$ 和 $m$ 都是偶数，一定不行；否则一定可以。

## D

$n < 5$ 一定无解。$n \geq 5$ 时，构造一个“$\infty$”形状的图（两个环有且仅有一个公共点）。

## E

我们将操作得到的字符串，视作块与块的拼接：每个块可以是 `空`、`0`、`1`或`01`。这些块拼起来，形成了最终的字符串。而每个字符串也可以用这些块表示出来。

进一步地，考虑怎么表示字符串，能让**块的数量最少**。发现首先要把空块全部删掉。然后如果两个块依次是 `0` 和 `1`，那么我们以一个块 `01` 可以代替，块数减少。除此之外没别的情况了，块的序列是确定的。因此任意最终字符串的，**最小块数**的表示方法，一定是**唯一**的。

设最小**块数**（注意不是字符串长度）恰好为 $m$ 的本质不同字符串数量为 $g(m)$，考虑如何转移。

若末尾为 `0` 或 `01`，则来自所有 $g(m - 1)$ 的所有情况；若结尾是 `1`，那就不能来自 $g(m - 1)$ 中末尾是 `0` 的情况，也就是要从 $g(m - 1)$ 中扣去 $g(m - 2)$。三种情况相加，即有

$$
g(m) = 3g(m - 1) - g(m - 2)
$$

这个递推非常眼熟，我们知道对于斐波那契数列 $F(x)$，有

$$
\begin{align*}
F(2x+2) &= F(2x+1)+F(2x)\\
&= 2F(2x)+F(2x-1)\\
&= 3F(2x)-F(2x-2)
\end{align*}
$$

这两个的递推是一样的。再由初值 $g(1) = 3 = F(4)$，得

$$
g(m) = F(2m + 2)
$$

现在要求 $\sum_{m=0}^n g(m)$，即求 $\sum_{m=0}^n F(2m + 2)$，由斐波那契数列求和恒等式

$$
\sum_{m=0}^n F(2m + 2) = F(2m + 3) - 1
$$

于是快速递推斐波那契数列即可，复杂度 $O(\log n)$。

> 这题 $n = 10^7$，也可以直接求出所有 $g(m)$ 之后求和，复杂度 $O(n)$。

## F

假如我在一个桶里放了 $a$ 个鲱鱼罐头和 $b$ 个鸡腿，那么奶龙抽到鳕鱼罐头的概率为

$$
f(a, b) = \frac{a}{2(a + b)} + \frac{n - a}{2(2n - a - b)}
$$

$a$ 和 $b$ 都是 $[0, n]$ 的整数，且 $a+b\neq 0$，$2n - a - b\neq 0$。现在要求 $f(a, b)$ 的最大值。

提供一个初等的解法。

设 $s = a + b$，有

$$
\begin{align*}
f(a,b) &= \frac{a}{2s} + \frac{n-a}{2(2n-s)} \\
&= \frac12 \left( \frac{a}{s} + \frac{n-a}{2n-s} \right)\\
&= \frac12 \left[ a\left( \frac{1}{s} - \frac{1}{2n-s} \right) + \frac{n}{2n-s} \right]\\
&:= \frac12 \left[ g(s)\times a + h(s) \right]
\end{align*}
$$

得：对于给定的 $s$，$f$ 是关于 $a$ 的一次函数。即最值一定出现在 $a$ 取值的两个端点。

对于所有 $s$，最值都是 $a$ 取端点时取到。

在 $1\leq s\leq n$ 时，$a\in[0, s]$，有

$$
f(0, s) = \frac{n}{2(2n - s)},~~~ f(s, 0) = \frac 12 + \frac{n - s}{2(2n-s)}
$$

在 $n \leq s\leq 2n - 1$ 时，$a\in[s - n, n]$，有

$$
f(n, s - n) = \frac{n}{2s},~~~ f(s - n, n) = 1 - \frac{n}{2s}
$$

由对称性，我们仅关注 $n \leq s \leq 2n - 1$ 的情况，设

$$
g(s) = \frac{n}{2s}
$$

于是两个最值可以写成 $g(s)$ 和 $1 - g(s)$，在定义域上，前者严格递减，后者严格递增。那么同样地，**全局最值一定会出现在 $s$ 在定义域中取两端的时候**。

于是我们将 $s$ 与 $a$ 的最值代入，能得到，当 $s = 1$ 且 $a = 1$，或 $s = 2n - 1$ 且 $a = n - 1$ 时，$f$ 取最大值

$$
\boxed {f_{max} = \frac{3n-2}{2(2n-1)}}
$$

## G

将三个点按照 $x$ 坐标排序。然后连接两个点并延长，看剩下那个点在直线的上方还是下方，就可以判断开口方向。正确性是由二次函数的凸性保证的。

## H

先将能选的区间处理出来。那么这题就变为：给 $O(n)$ 个区间，问最少选几个，能将覆盖 $[1, n]$。

经典贪心。从点 $1$ 开始，不断选能到的，最远的右端点，复杂度 $O(n)$。

## I

若 $n$ 是奇数，构造 $n$ 个 `a` 即可；否则在序列最后再加一个 `b`，正确性显然。

## J

设 $f(0/1)$ 表示最后一次是减/加的情况下，最优的答案。对于每个位置，可以不选，如果选的话有 $f(0)+x\rightarrow f'(1)$，和 $f(1)-x \rightarrow f'(0)$。

规定了第一次一定是加，但是最后一次的符号是任意的。那么我们从后往前扫过去 dp 就行了，最后答案为 $f(1)$。

## K

二分。检查时照题意模拟即可，复杂度 $O(n\log V)$，$V$ 为值域。

## L

本质上是看每个位置最终去了哪里。

设 $f(1, n)$ 为 $\{1, 2, \dots, n\}$ 的排列按题意操作之后的结果。设 $f'(1, n)$ 为将 $f(1, n)$ 再翻转过来。那么有

$$
\begin{align*}
f(1, n) &= \{n, f'(1, n - 1)\}\\
&= \{n, f(1, n - 2), n - 1\}\\
&= \{n, n - 2, f'(1, n - 3), n - 1\}\\
&= \dots \\
&= \{n, n - 2, n - 4, \dots, 1, \dots, n - 3, n - 1\}
\end{align*}
$$

也就是说 

$$
\{a_1, a_2, \dots, a_n\}\rightarrow\{a_{n}, a_{n-2}, \dots, a_1, \dots, a_{n - 3}, a_{n-1}\}
$$

现在知道操作完的序列，那么变回去就行了。

## M

按题意模拟。